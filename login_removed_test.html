<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™»å½•ç•Œé¢ç§»é™¤æµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #0a0a2a;
            font-family: Arial, sans-serif;
            color: #ffffff;
        }
        
        #gameCanvas {
            display: block;
            margin: 20px auto;
            border: 2px solid #00ffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }
        
        .test-info {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px auto;
            max-width: 800px;
        }
        
        .status {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px auto;
            max-width: 800px;
        }
        
        .success {
            color: #00ff00;
        }
        
        .error {
            color: #ff0000;
        }
        
        .info {
            color: #00ffff;
        }
    </style>
</head>
<body>
    <div class="test-info">
        <h2>ğŸ” ç™»å½•ç•Œé¢ç§»é™¤æµ‹è¯•</h2>
        <p><strong>æµ‹è¯•ç›®æ ‡ï¼š</strong>éªŒè¯æ¸¸æˆå¯åŠ¨æ—¶ä¸å†æ˜¾ç¤ºç™»å½•ç•Œé¢ï¼Œç›´æ¥è¿›å…¥æ¸¸æˆ</p>
        <p><strong>ä¿®æ”¹å†…å®¹ï¼š</strong></p>
        <ul>
            <li>ä¿®æ”¹ js/main.js æ„é€ å‡½æ•°ï¼Œè®¾ç½® gameStarted = true</li>
            <li>ç›´æ¥è°ƒç”¨ this.start() å¯åŠ¨æ¸¸æˆ</li>
            <li>ç§»é™¤ç™»å½•ç•Œé¢çš„æ¸²æŸ“å’Œæ›´æ–°é€»è¾‘</li>
        </ul>
    </div>

    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <div class="status" id="status">
        <strong>æµ‹è¯•çŠ¶æ€ï¼š</strong><br>
        - æ¸¸æˆçŠ¶æ€ï¼šå¯åŠ¨ä¸­...<br>
        - ç™»å½•ç•Œé¢ï¼šæ£€æŸ¥ä¸­...<br>
        - æ¸¸æˆç•Œé¢ï¼šæ£€æŸ¥ä¸­...<br>
        - åŠŸèƒ½éªŒè¯ï¼šå¾…æµ‹è¯•
    </div>

    <script type="module">
        // å¯¼å…¥æ¸¸æˆæ¨¡å—
        import Main from './js/main.js';

        // åˆå§‹åŒ–æ¸¸æˆ
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // è®¾ç½®å…¨å±€å˜é‡
        window.GameGlobal = {
            canvas: canvas,
            ctx: ctx
        };

        // å¯åŠ¨æ¸¸æˆ
        const game = new Main();

        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus() {
            const statusDiv = document.getElementById('status');
            
            if (GameGlobal.databus) {
                const loginVisible = GameGlobal.loginPage && GameGlobal.loginPage.visible;
                const gameStarted = GameGlobal.main && GameGlobal.main.gameStarted;
                
                statusDiv.innerHTML = `
                    <strong>æµ‹è¯•çŠ¶æ€ï¼š</strong><br>
                    <span class="${gameStarted ? 'success' : 'error'}">- æ¸¸æˆçŠ¶æ€ï¼š${gameStarted ? 'å·²å¯åŠ¨' : 'æœªå¯åŠ¨'}</span><br>
                    <span class="${!loginVisible ? 'success' : 'error'}">- ç™»å½•ç•Œé¢ï¼š${loginVisible ? 'æ˜¾ç¤ºä¸­' : 'å·²éšè—'}</span><br>
                    <span class="${gameStarted ? 'success' : 'error'}">- æ¸¸æˆç•Œé¢ï¼š${gameStarted ? 'å·²æ˜¾ç¤º' : 'æœªæ˜¾ç¤º'}</span><br>
                    <span class="info">- åˆ†æ•°ï¼š${GameGlobal.databus.score}</span><br>
                    <span class="info">- å®‰å…¨ç­‰çº§ï¼š${GameGlobal.databus.securityLevel}%</span><br>
                    <span class="info">- çŸ¥è¯†ç‚¹ï¼š${GameGlobal.databus.knowledgePoints}</span><br>
                    <span class="info">- å¨èƒæ•°é‡ï¼š${GameGlobal.databus.threats.length}</span><br>
                    <span class="info">- å­å¼¹æ•°é‡ï¼š${GameGlobal.databus.bullets.length}</span>
                `;
            }
        }

        // æ·»åŠ è°ƒè¯•ä¿¡æ¯
        console.log('ğŸ” ç™»å½•ç•Œé¢ç§»é™¤æµ‹è¯•å¼€å§‹');
        console.log('ğŸ® æ¸¸æˆå·²å¯åŠ¨');
        console.log('ğŸ“ ç”»å¸ƒå°ºå¯¸:', canvas.width, 'x', canvas.height);

        // æ£€æŸ¥ç™»å½•ç•Œé¢çŠ¶æ€
        setTimeout(() => {
            console.log('ğŸ” æ£€æŸ¥ç™»å½•ç•Œé¢çŠ¶æ€...');
            if (GameGlobal.loginPage) {
                console.log('ğŸ“‹ ç™»å½•ç•Œé¢å¯¹è±¡å­˜åœ¨:', GameGlobal.loginPage);
                console.log('ğŸ‘ï¸ ç™»å½•ç•Œé¢å¯è§æ€§:', GameGlobal.loginPage.visible);
            } else {
                console.log('âŒ ç™»å½•ç•Œé¢å¯¹è±¡ä¸å­˜åœ¨');
            }
            
            if (GameGlobal.main) {
                console.log('ğŸ® ä¸»æ¸¸æˆå¯¹è±¡å­˜åœ¨:', GameGlobal.main);
                console.log('ğŸš€ æ¸¸æˆå¯åŠ¨çŠ¶æ€:', GameGlobal.main.gameStarted);
            } else {
                console.log('âŒ ä¸»æ¸¸æˆå¯¹è±¡ä¸å­˜åœ¨');
            }
        }, 1000);

        // å®šæœŸæ£€æŸ¥æ¸¸æˆçŠ¶æ€
        setInterval(() => {
            updateStatus();
            
            if (GameGlobal.databus) {
                console.log('ğŸ“Š å½“å‰æ¸¸æˆçŠ¶æ€:');
                console.log('  - åˆ†æ•°:', GameGlobal.databus.score);
                console.log('  - çŸ¥è¯†ç‚¹:', GameGlobal.databus.knowledgePoints);
                console.log('  - å®‰å…¨ç­‰çº§:', GameGlobal.databus.securityLevel);
                console.log('  - å¨èƒæ•°é‡:', GameGlobal.databus.threats.length);
                console.log('  - å­å¼¹æ•°é‡:', GameGlobal.databus.bullets.length);
                
                if (GameGlobal.loginPage) {
                    console.log('  - ç™»å½•ç•Œé¢å¯è§:', GameGlobal.loginPage.visible);
                }
                
                if (GameGlobal.main) {
                    console.log('  - æ¸¸æˆå¯åŠ¨çŠ¶æ€:', GameGlobal.main.gameStarted);
                }
            }
        }, 2000);

        // æµ‹è¯•ç»“æœéªŒè¯
        setTimeout(() => {
            console.log('âœ… æµ‹è¯•ç»“æœéªŒè¯:');
            
            const loginVisible = GameGlobal.loginPage && GameGlobal.loginPage.visible;
            const gameStarted = GameGlobal.main && GameGlobal.main.gameStarted;
            const hasThreats = GameGlobal.databus && GameGlobal.databus.threats.length > 0;
            
            if (!loginVisible && gameStarted) {
                console.log('ğŸ‰ æµ‹è¯•é€šè¿‡ï¼ç™»å½•ç•Œé¢å·²æˆåŠŸç§»é™¤ï¼Œæ¸¸æˆç›´æ¥å¯åŠ¨');
                document.getElementById('status').innerHTML += '<br><span class="success">ğŸ‰ æµ‹è¯•é€šè¿‡ï¼ç™»å½•ç•Œé¢å·²æˆåŠŸç§»é™¤</span>';
            } else {
                console.log('âŒ æµ‹è¯•å¤±è´¥ï¼ç™»å½•ç•Œé¢ä»ç„¶æ˜¾ç¤ºæˆ–æ¸¸æˆæœªå¯åŠ¨');
                document.getElementById('status').innerHTML += '<br><span class="error">âŒ æµ‹è¯•å¤±è´¥ï¼ç™»å½•ç•Œé¢ä»ç„¶æ˜¾ç¤º</span>';
            }
            
            if (hasThreats) {
                console.log('ğŸ¯ æ¸¸æˆæ­£å¸¸è¿è¡Œï¼Œå¨èƒå·²ç”Ÿæˆ');
            } else {
                console.log('âš ï¸ æ¸¸æˆå¯èƒ½æœªæ­£å¸¸è¿è¡Œï¼Œæ²¡æœ‰å¨èƒç”Ÿæˆ');
            }
        }, 5000);
    </script>
</body>
</html> 