# 能量系统测试说明

## 🎯 问题解决

### 原始问题
- 游戏开始时能量不足，无法发射子弹
- 控制台显示"能量不足, 无法发射"
- 按钮选择Agent后无法正常部署

### 解决方案

#### 1. 提高初始能量值
```javascript
// 修改前
this.energy = 100;
this.maxEnergy = 100;

// 修改后  
this.energy = 300;
this.maxEnergy = 300;
```

#### 2. 优化能量消耗
```javascript
// 修改前
this.agentDeployCost = 30; // Agent部署成本
this.bulletShootCost = 5;  // 子弹发射成本

// 修改后
this.agentDeployCost = 50; // Agent部署成本，降低门槛
this.bulletShootCost = 3;  // 子弹发射成本，降低门槛
```

#### 3. 加快能量恢复
```javascript
// 修改前
this.energyRegenRate = 0.5;

// 修改后
this.energyRegenRate = 1.0; // 能量恢复速率，加快恢复
```

#### 4. 统一能量管理
- 所有能量操作都通过 `DataBus` 进行
- 指挥官和UI显示同步 `DataBus` 的能量值
- 添加能量检查方法

## 🎮 游戏平衡优化

### 能量系统
- **初始能量**: 300/300
- **Agent部署**: 50能量
- **子弹发射**: 3能量  
- **特殊技能**: 30能量
- **恢复速率**: 1.0/帧

### 游戏节奏
- **威胁生成**: 每80帧生成一个（降低频率）
- **射击冷却**: 15帧（加快射击）
- **最大Agent**: 4个

## 🧪 测试步骤

### 1. 启动游戏
```javascript
// 控制台应该显示
"游戏开始！初始能量: 300"
```

### 2. 测试能量显示
- 顶部信息栏显示正确的能量值
- 底部能量条显示 300/300
- 能量条颜色为绿色（充足）

### 3. 测试Agent部署
- 点击底部按钮选择Agent
- 点击屏幕部署Agent
- 能量应该减少50点
- 控制台显示"成功部署 [Agent名称]"

### 4. 测试自动射击
- 指挥官应该自动发射子弹
- 子弹消耗3点能量
- 能量自动恢复

### 5. 测试能量不足
- 当能量低于3点时，无法发射子弹
- 当能量低于50点时，无法部署Agent
- 控制台显示相应的提示信息

## 📊 预期结果

### 游戏开始时
- 能量: 300/300
- 安全等级: 100%
- 分数: 0
- 知识点: 0

### 部署第一个Agent后
- 能量: 250/300
- 可以继续部署更多Agent
- 可以正常发射子弹

### 持续游戏
- 能量自动恢复
- 可以持续部署Agent和发射子弹
- 游戏体验流畅

## 🔧 调试信息

游戏会定期输出状态信息：
```javascript
// 每300帧输出一次
"游戏状态 - 能量: 250/300, 安全等级: 95%, 分数: 15"
```

## ✅ 验证清单

- [ ] 游戏启动时能量为300
- [ ] 可以正常选择Agent按钮
- [ ] 可以成功部署Agent
- [ ] 指挥官自动发射子弹
- [ ] 能量自动恢复
- [ ] 能量不足时显示提示
- [ ] UI正确显示能量值
- [ ] 游戏体验流畅

现在游戏应该具有充足的初始能量，可以正常进行所有操作！ 